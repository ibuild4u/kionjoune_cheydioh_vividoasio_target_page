<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vivid Oasis ‚Äî Our Partners & Properties</title>
  <style>
    :root{
      --ink:#0f1115;
      --paper:#f8fafc;
      --muted:#6b7280;
      --line:#2b2f36;

      --card:rgba(255,255,255,.86);
      --glass:rgba(16,17,20,.84);

      --ok:#16a34a;
      --warn:#f59e0b;
      --soft:rgba(16,17,20,.06);
      --soft2:rgba(16,17,20,.10);
      
      /* River theme colors */
      --river-start:#0ea5e9;
      --river-mid:#06b6d4;
      --river-end:#14b8a6;
      --water-light:rgba(14,165,233,.15);
      --water-glow:rgba(6,182,212,.4);
      --dock:rgba(255,255,255,.92);
      --dock-shadow:rgba(14,165,233,.25);
    }

    html,body{margin:0;padding:0;background:#f8fafc;color:var(--ink);scroll-behavior:smooth;}
    body{font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial; letter-spacing:-0.01em;}

    /* SVG Journey Overlay */
    .journey-overlay{
      position:fixed;
      top:0; left:0;
      width:100px;
      height:100vh;
      pointer-events:none;
      z-index:100;
    }
    
    /* Form Cards - pinned notes inside content */
    .formCard{
      position:absolute;
      top:20px;
      left:-380px;
      width:320px;
      background:rgba(255,255,255,0.96);
      border-radius:16px;
      padding:24px;
      box-shadow:0 12px 40px rgba(0,0,0,0.25), 0 0 0 1px rgba(14,165,233,0.15);
      backdrop-filter:blur(10px);
      z-index:10;
    }
    
    .formCard h3{
      margin:0 0 20px 0;
      color:var(--river-start);
      font-size:1.5rem;
      font-weight:800;
    }
    
    .formCard label{
      display:flex;
      align-items:center;
      gap:12px;
      padding:12px 0;
      cursor:pointer;
      font-size:1rem;
      color:var(--ink);
      transition:color 0.2s ease;
    }
    
    .formCard label:hover{
      color:var(--river-mid);
    }
    
    .formCard input[type="radio"]{
      width:20px;
      height:20px;
      cursor:pointer;
    }
    
    .formCard select{
      width:100%;
      padding:12px 16px;
      border-radius:12px;
      border:2px solid #e5e7eb;
      font-size:1rem;
      background:#fff;
      cursor:pointer;
      transition:border-color 0.2s ease;
    }
    
    .formCard select:focus{
      outline:none;
      border-color:var(--river-mid);
    }
    
    .formCard .nextBtn{
      width:100%;
      padding:14px;
      background:linear-gradient(135deg, var(--river-start), var(--river-mid));
      color:#fff;
      border:none;
      border-radius:12px;
      font-size:1rem;
      font-weight:700;
      cursor:pointer;
      margin-top:20px;
      transition:transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .formCard .nextBtn:hover{
      transform:translateY(-2px);
      box-shadow:0 8px 20px rgba(14,165,233,0.4);
    }
    
    .trail{
      fill:none;
      stroke:rgba(255,255,255,0.4);
      stroke-width:4;
      stroke-dasharray:12,8;
      stroke-linecap:round;
      filter:drop-shadow(0 0 8px rgba(255,255,255,0.6));
    }
    
    .nodeRing{
      fill:rgba(255,255,255,0.15);
      stroke:rgba(255,255,255,0.8);
      stroke-width:3;
      filter:drop-shadow(0 0 12px rgba(255,255,255,0.8));
      transition:all 0.3s ease;
    }
    
    .nodeRing:hover{
      fill:rgba(255,255,255,0.3);
      filter:drop-shadow(0 0 20px rgba(255,255,255,1));
    }
    
    .iconStroke{
      fill:none;
      stroke:#fff;
      stroke-width:2.5;
      stroke-linecap:round;
      stroke-linejoin:round;
    }

    /* Clean vertical sections with video backgrounds */
    .hero{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      color:#fff;
      text-align:center;
      padding:40px 20px;
      position:relative;
      overflow:hidden;
    }
    
    .hero .video-background,
    .section .video-background{
      position:absolute;
      top:0; left:0;
      width:100%;
      height:100%;
      object-fit:cover;
      z-index:0;
    }
    
    .hero::after,
    .section::after{
      content:'';
      position:absolute;
      top:0; left:0;
      width:100%;
      height:100%;
      background:rgba(0,0,0,0.4);
      z-index:1;
    }
    
    .hero > div{
      position:relative;
      z-index:2;
    }
    
    .hero h1{
      font-size:clamp(2.5rem, 8vw, 5rem);
      margin:0 0 20px 0;
      font-weight:900;
      letter-spacing:-0.03em;
      text-shadow:0 4px 20px rgba(0,0,0,0.5);
    }
    
    .hero p{
      font-size:clamp(1.1rem, 3vw, 1.5rem);
      margin:0;
      opacity:0.95;
      text-shadow:0 2px 10px rgba(0,0,0,0.5);
    }
    
    .section{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:80px 60px;
      position:relative;
      overflow:hidden;
    }
    
    .content{
      max-width:700px;
      padding:40px 50px;
      background:rgba(255,255,255,0.96);
      border-radius:24px;
      box-shadow:0 30px 80px rgba(0,0,0,0.4);
      backdrop-filter:blur(10px);
      position:relative;
      z-index:2;
    }
    
    .content h2{
      font-size:clamp(2rem, 5vw, 3rem);
      margin:0 0 24px 0;
      font-weight:800;
      letter-spacing:-0.02em;
      color:var(--river-start);
    }
    
    .content p{
      font-size:1.125rem;
      line-height:1.7;
      color:#475569;
      margin:0 0 16px 0;
    }
    
    .content ul{
      list-style:none;
      padding:0;
      margin:20px 0;
    }
    
    .content li{
      padding:12px 0;
      padding-left:32px;
      position:relative;
      font-size:1.05rem;
      color:#64748b;
    }
    
    .content li::before{
      content:'‚úì';
      position:absolute;
      left:0;
      color:var(--river-start);
      font-weight:900;
      font-size:1.3rem;
    }
    
    @media (max-width: 900px){
      .section{
        padding:60px 30px;
      }
      
      .content{
        padding:30px 35px;
      }
    }

    /* Brand Bar */
    .brandBar{
      position:fixed; top:16px; left:16px; right:16px;
      z-index:100;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:12px 20px;
      border-radius:16px;
      background:rgba(255,255,255,.95);
      border:1px solid rgba(255,255,255,.3);
      backdrop-filter:blur(12px);
      box-shadow:0 8px 32px rgba(0,0,0,.2);
    }
    
    .brandLeft{display:flex; align-items:center; gap:12px;}
    
    .logoMark{
      width:34px; height:34px; border-radius:12px;
      background:linear-gradient(135deg, var(--river-start), var(--river-mid));
      box-shadow:0 4px 12px rgba(14,165,233,.4);
    }
    
    .brandText{display:flex; flex-direction:column; gap:2px;}
    .brandName{font-weight:800; font-size:14px; color:var(--ink);}
    .brandTag{font-size:12px; color:var(--muted);}
    
    .brandRight{display:flex; align-items:center; gap:10px;}
    
    .chip{
      font-size:12px; color:var(--ink);
      border:1px solid rgba(0,0,0,.1);
      background:rgba(0,0,0,.04);
      padding:6px 12px; border-radius:8px;
      font-weight:600;
    }
    
    .primaryBtn{
      background:linear-gradient(135deg, var(--river-start), var(--river-mid));
      color:#fff;
      border:none;
      padding:8px 16px;
      border-radius:10px;
      font-weight:700;
      font-size:13px;
      cursor:pointer;
      box-shadow:0 4px 12px rgba(14,165,233,.3);
      transition:all 0.2s ease;
    }
    
    .primaryBtn:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(14,165,233,.4);
    }
    
    /* Portfolio Modal */
    .modal{
      display:none;
      position:fixed;
      top:0; left:0;
      width:100%; height:100%;
      background:rgba(0,0,0,0.8);
      z-index:200;
      align-items:center;
      justify-content:center;
      padding:20px;
    }
    
    .modal.active{display:flex;}
    
    .modalContent{
      background:#fff;
      border-radius:20px;
      padding:40px;
      max-width:900px;
      width:100%;
      max-height:90vh;
      overflow-y:auto;
      position:relative;
    }
    
    .closeBtn{
      position:absolute;
      top:20px; right:20px;
      background:rgba(0,0,0,.1);
      border:none;
      width:36px; height:36px;
      border-radius:50%;
      cursor:pointer;
      font-size:20px;
      transition:all 0.2s ease;
    }
    
    .closeBtn:hover{
      background:rgba(0,0,0,.2);
      transform:rotate(90deg);
    }
    
    /* Property Cards */
    .propertyGrid{
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(280px, 1fr));
      gap:24px;
      margin-top:30px;
    }
    
    .propertyCard{
      border:1px solid #e5e7eb;
      border-radius:16px;
      overflow:hidden;
      background:#fff;
      transition:transform 0.3s ease, box-shadow 0.3s ease;
      cursor:pointer;
    }
    
    .propertyCard:hover{
      transform:translateY(-4px);
      box-shadow:0 12px 40px rgba(0,0,0,0.15);
    }
    
    .propertyImage{
      width:100%;
      height:180px;
      background:linear-gradient(135deg, var(--river-start), var(--river-mid));
      position:relative;
      overflow:hidden;
    }
    
    .propertyImage::before{
      content:'';
      position:absolute;
      inset:0;
      background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect fill="rgba(255,255,255,0.1)" x="10" y="30" width="30" height="40" rx="2"/><rect fill="rgba(255,255,255,0.15)" x="45" y="25" width="35" height="45" rx="2"/><rect fill="rgba(255,255,255,0.1)" x="60" y="15" width="25" height="55" rx="2"/></svg>');
      background-size:cover;
      opacity:0.6;
    }
    
    .propertyBody{
      padding:20px;
    }
    
    .propertyTitle{
      margin:0 0 8px 0;
      font-size:1.1rem;
      font-weight:700;
      color:var(--ink);
    }
    
    .propertyAddress{
      margin:0 0 12px 0;
      font-size:0.9rem;
      color:var(--muted);
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
      overflow:hidden;
    }
    
    .propertyPrice{
      font-size:1.25rem;
      font-weight:800;
      color:var(--river-start);
      margin:0;
    }
    
    .propertyMeta{
      display:flex;
      gap:12px;
      margin-top:12px;
      padding-top:12px;
      border-top:1px solid #f1f5f9;
    }
    
    .metaItem{
      display:flex;
      align-items:center;
      gap:4px;
      font-size:0.85rem;
      color:var(--muted);
    }

    /* Brand bar */
    .brandBar{
      position:fixed; top:16px; left:16px; right:16px;
      z-index:30;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:12px 14px;
      border-radius:16px;
      background:rgba(255,255,255,.74);
      border:1px solid rgba(16,17,20,.10);
      backdrop-filter: blur(12px);
      box-shadow:0 18px 55px rgba(0,0,0,.12);
    }
    .brandLeft{display:flex; align-items:center; gap:12px; min-width: 0;}
    .logoMark{
      width:34px; height:34px; border-radius:12px;
      background: radial-gradient(14px 14px at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.10)),
                  radial-gradient(20px 16px at 70% 70%, rgba(255,255,255,.55), rgba(255,255,255,.06)),
                  linear-gradient(135deg, rgba(16,17,20,.92), rgba(16,17,20,.62));
      border:1px solid rgba(16,17,20,.12);
      box-shadow:0 10px 26px rgba(0,0,0,.16);
    }
    .brandText{display:flex; flex-direction:column; gap:2px; min-width:0;}
    .brandName{font-weight:800; font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
    .brandTag{font-size:12px; color:rgba(16,17,20,.60); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}

    .brandRight{display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:flex-end;}
    .chip{
      font-size:12px; color:rgba(16,17,20,.70);
      border:1px solid rgba(16,17,20,.12);
      background:rgba(16,17,20,.04);
      padding:8px 10px; border-radius:999px;
      user-select:none;
    }
    .chipStrong{
      background:rgba(22,163,74,.10);
      border-color:rgba(22,163,74,.18);
      color:rgba(21,128,61,.95);
      font-weight:650;
    }

    .primaryBtn{
      border:1px solid rgba(16,17,20,.12);
      background:rgba(16,17,20,.92);
      color:rgba(255,255,255,.94);
      padding:10px 12px;
      border-radius:12px;
      font-size:13px;
      cursor:pointer;
      box-shadow:0 16px 40px rgba(0,0,0,.18);
    }
    .ghostBtn{
      border:1px solid rgba(16,17,20,.12);
      background:rgba(255,255,255,.62);
      color:rgba(16,17,20,.84);
      padding:10px 12px;
      border-radius:12px;
      font-size:13px;
      cursor:pointer;
    }

    /* Stage (River journey canvas) */
    .stage{
      min-height:400vh;
      background:
        radial-gradient(1400px 800px at 50% 20%, var(--water-light), transparent),
        radial-gradient(1200px 700px at 50% 60%, rgba(20,184,166,.08), transparent),
        linear-gradient(180deg, #f0f9ff 0%, #f8fafc 50%, #ecfeff 100%);
      position:relative;
    }
    .frame{
      position:sticky;
      top:0;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      pointer-events:none;
    }
    .board{
      width:min(800px, 90vw);
      height:min(660px,84vh);
      border-radius:22px;
      background:var(--card);
      border:1px solid rgba(16,17,20,.10);
      box-shadow:0 22px 70px rgba(0,0,0,.16);
      overflow-y:auto;
      overflow-x:hidden;
      position:relative;
      pointer-events:all;
    }
    svg{width:100%; height:auto; min-height:2400px;}
    
    /* River trail - flowing water gradient */
    .trail{
      fill:none; 
      stroke:url(#riverGradient); 
      stroke-width:16; 
      stroke-linecap:round; 
      opacity:.85;
      filter:drop-shadow(0 4px 12px var(--water-glow));
    }
    
    /* Dock connector lines */
    .dockLine{
      fill:none;
      stroke:var(--river-mid);
      stroke-width:2;
      stroke-dasharray:4 6;
      opacity:.5;
    }
    
    /* Stepping stone nodes */
    .nodeRing{
      fill:rgba(255,255,255,.95); 
      stroke:var(--river-mid); 
      stroke-width:3;
      filter:drop-shadow(0 6px 16px var(--dock-shadow));
    }
    
    .nodeRing:hover{
      fill:rgba(14,165,233,.12);
      stroke:var(--river-start);
    }
    
    .iconStroke{
      fill:none; 
      stroke:var(--river-start); 
      stroke-width:3.2; 
      stroke-linecap:round; 
      stroke-linejoin:round;
    }

    /* HUD ‚Äî Integrated SVG tour guide */
    .hud{
      /* Positioned absolutely within SVG, updated via JS */
      position:absolute;
      z-index:5;
      width:280px;
      background:rgba(16,17,20,.94);
      border:1px solid rgba(255,255,255,.14);
      border-radius:14px;
      padding:16px;
      color:rgba(255,255,255,.94);
      box-shadow:0 16px 50px rgba(0,0,0,.40);
      pointer-events:all;
      overflow:hidden;
      display:flex; flex-direction:column; gap:10px;
    }
    
    .hudStep{
      font-size:10px; letter-spacing:.12em; text-transform:uppercase; opacity:.68;
      color:rgba(22,163,74,.92); margin:0;
    }
    .hudTitle{
      font-size:16px; letter-spacing:-.01em; font-weight:700; margin:0; line-height:1.25;
    }
    .hudBody{
      font-size:12px; letter-spacing:-.003em; margin:6px 0 0 0; line-height:1.4; opacity:.82;
      color:rgba(255,255,255,.78);
    }
    .hudDesc{
      font-size:11px; color:rgba(255,255,255,.60); line-height:1.5; margin:4px 0 0 0;
    }
    
    .hudDivider{
      height:1px; background:rgba(255,255,255,.08); margin:8px 0;
    }
    
    .hudNextStep{
      display:flex; flex-direction:column; gap:4px;
    }
    .hudNextLabel{
      font-size:9px; letter-spacing:.10em; text-transform:uppercase; opacity:.50;
      color:rgba(255,255,255,.60);
    }
    .hudNextName{
      font-size:12px; font-weight:600; color:rgba(134,239,172,.88);
    }
    .hudNextHint{
      font-size:10px; color:rgba(255,255,255,.50); opacity:.70;
    }
    
    .hudProgress{
      display:flex; align-items:center; gap:6px; margin-top:6px;
    }
    .hudProgressBar{
      flex:1; height:3px; background:rgba(255,255,255,.12); border-radius:2px; overflow:hidden;
    }
    .hudProgressFill{
      height:100%; background:rgba(22,163,74,.70); border-radius:2px; width:0%;
    }
    .hudProgressLabel{
      font-size:9px; color:rgba(255,255,255,.50); min-width:24px;
    }

    /* Dock connector lines */
    .dockLine{
      stroke:rgba(14,165,233,.25);
      stroke-width:2;
      stroke-dasharray:6 4;
      opacity:.6;
      pointer-events:none;
    }
    
    /* Interactive Step UI Panels - Floating Docks */
    .stepUI{
      width:220px;
      background:var(--dock);
      border:2px solid rgba(14,165,233,.25);
      border-radius:16px;
      padding:18px;
      box-shadow:
        0 8px 24px var(--dock-shadow),
        0 2px 8px rgba(6,182,212,.15),
        inset 0 1px 0 rgba(255,255,255,.8);
      display:flex;
      flex-direction:column;
      gap:12px;
      pointer-events:all;
      backdrop-filter:blur(8px);
      transition:all .3s ease;
    }
    
    .stepUI:hover{
      border-color:rgba(14,165,233,.45);
      box-shadow:
        0 12px 32px var(--dock-shadow),
        0 4px 12px rgba(6,182,212,.25),
        inset 0 1px 0 rgba(255,255,255,.9);
      transform:translateY(-2px);
    }
    
    .stepUI h3{
      margin:0 0 10px 0;
      font-size:15px;
      font-weight:800;
      color:var(--river-mid);
      letter-spacing:-.01em;
      padding-bottom:8px;
      border-bottom:2px solid rgba(14,165,233,.15);
    }
    
    .stepUI label{
      display:flex;
      align-items:center;
      gap:8px;
      font-size:13px;
      cursor:pointer;
      padding:6px 0;
    }
    
    .stepUI input[type="radio"],
    .stepUI input[type="checkbox"]{
      cursor:pointer;
    }
    
    .stepUI select{
      padding:8px 10px;
      border:1px solid rgba(16,17,20,.18);
      border-radius:8px;
      font-size:13px;
      background:rgba(255,255,255,.90);
      cursor:pointer;
    }
    
    .stepUI input[type="range"]{
      width:100%;
      cursor:pointer;
    }
    
    .stepUI input[type="number"]{
      width:60px;
      padding:4px 6px;
      border:1px solid rgba(16,17,20,.18);
      border-radius:6px;
      font-size:12px;
    }
    
    .stepUI p{
      margin:4px 0;
      font-size:12px;
      color:var(--muted);
    }
    
    .stepUI strong{
      color:var(--ink);
      font-weight:700;
    }
    
    .stepBtn{
      margin-top:8px;
      padding:10px 14px;
      border:2px solid var(--river-start);
      border-radius:10px;
      background:linear-gradient(135deg, var(--river-start), var(--river-mid));
      color:#fff;
      font-size:13px;
      font-weight:700;
      cursor:pointer;
      transition:all .3s ease;
      box-shadow:0 2px 8px rgba(14,165,233,.3);
    }
    
    .stepBtn:hover{
      background:linear-gradient(135deg, var(--river-mid), var(--river-end));
      border-color:var(--river-mid);
      box-shadow:0 4px 12px rgba(14,165,233,.4);
      transform:translateY(-1px);
    }
    
    .stepBtnPrimary{
      background:rgba(22,163,74,.14);
      border-color:rgba(22,163,74,.30);
      color:rgba(21,128,61,.95);
    }
    
    .stepBtnPrimary:hover{
      background:rgba(22,163,74,.22);
      border-color:rgba(22,163,74,.50);
    }

    /* Info Card (onboarding) */
    .infoCard{
      position:fixed;
      right:18px; bottom:18px;
      z-index:25;
      width:min(420px, 92vw);
      border-radius:18px;
      background:rgba(255,255,255,.78);
      border:1px solid rgba(16,17,20,.10);
      box-shadow:0 18px 60px rgba(0,0,0,.14);
      backdrop-filter: blur(12px);
      overflow:hidden;
    }
    .infoTop{
      padding:14px 14px 10px 14px;
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
      border-bottom:1px solid rgba(16,17,20,.08);
      background:rgba(255,255,255,.82);
    }
    .infoTitle{margin:0; font-size:13px; font-weight:800; letter-spacing:-0.01em;}
    .infoClose{
      border:1px solid rgba(16,17,20,.10);
      background:rgba(16,17,20,.03);
      padding:8px 10px;
      border-radius:12px;
      font-size:12px;
      cursor:pointer;
    }
    .infoBody{padding:12px 14px 14px 14px;}
    .infoLead{margin:0 0 10px 0; font-size:13px; color:rgba(16,17,20,.72); line-height:1.45;}
    .infoRow{display:flex; gap:10px; flex-wrap:wrap;}
    .mini{
      flex:1 1 160px;
      border:1px solid rgba(16,17,20,.10);
      background:rgba(255,255,255,.90);
      border-radius:14px;
      padding:10px 10px;
    }
    .mini h4{margin:0 0 6px 0; font-size:12px;}
    .mini p{margin:0; font-size:12px; color:rgba(16,17,20,.64); line-height:1.35;}

    /* Properties Overlay */
    .overlay{
      position:fixed; inset:0; z-index:40;
      background:rgba(10,10,12,.62);
      backdrop-filter: blur(12px);
      display:none;
    }
    .overlay.isOpen{display:block;}
    .sheet{
      position:absolute; left:50%; top:50%;
      transform:translate(-50%,-50%);
      width:min(1180px, 96vw);
      height:min(760px, 92vh);
      border-radius:22px;
      background:rgba(255,255,255,.92);
      border:1px solid rgba(16,17,20,.10);
      box-shadow:0 30px 90px rgba(0,0,0,.28);
      overflow:hidden;
      display:grid;
      grid-template-columns: 1fr 380px;
    }
    .sheetHeader{
      grid-column:1 / -1;
      padding:18px 18px 14px 18px;
      border-bottom:1px solid rgba(16,17,20,.10);
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      background:rgba(255,255,255,.95);
    }
    .titleBlock{display:flex; flex-direction:column; gap:4px; min-width:0;}
    .titleBlock h2{margin:0; font-size:18px; letter-spacing:-.01em;}
    .titleBlock p{margin:0; color:var(--muted); font-size:13px; line-height:1.3;}
    .headerActions{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:flex-end;}
    .closeBtn{
      border:1px solid rgba(16,17,20,.12);
      background:rgba(16,17,20,.04);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-size:13px;
    }

    .gridPane{padding:16px; overflow:auto;}
    .toolbar{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:12px;}
    .input{
      border:1px solid rgba(16,17,20,.14);
      background:#fff;
      border-radius:12px;
      padding:10px 12px;
      font-size:13px;
      width:min(420px,100%);
    }
    .pill{
      font-size:12px;
      color:rgba(16,17,20,.72);
      border:1px solid rgba(16,17,20,.12);
      background:rgba(16,17,20,.04);
      padding:8px 10px;
      border-radius:999px;
      user-select:none;
    }
    .pillOk{
      background:rgba(22,163,74,.10);
      border-color:rgba(22,163,74,.18);
      color:rgba(21,128,61,.95);
      font-weight:650;
    }
    .pillWarn{
      background:rgba(245,158,11,.10);
      border-color:rgba(245,158,11,.22);
      color:rgba(161,98,7,.95);
      font-weight:650;
    }

    .cards{display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:12px;}
    @media (max-width: 1020px){
      .sheet{grid-template-columns:1fr;}
      .cards{grid-template-columns:1fr;}
    }

    .card{
      border:1px solid rgba(16,17,20,.10);
      background:#fff;
      border-radius:16px;
      overflow:hidden;
      display:grid;
      grid-template-columns: 150px 1fr;
      min-height:138px;
      position:relative;
    }
    .cardSelected{
      outline:2px solid rgba(22,163,74,.22);
      box-shadow:0 18px 55px rgba(22,163,74,.10);
    }
    .badge{
      position:absolute; top:10px; left:10px;
      background:rgba(16,17,20,.82);
      color:rgba(255,255,255,.92);
      font-size:11px;
      padding:6px 8px;
      border-radius:999px;
      letter-spacing:.01em;
    }

    .thumb{
      background:linear-gradient(135deg, rgba(16,17,20,.07), rgba(16,17,20,.02));
      display:grid;
      place-items:center;
      color:rgba(16,17,20,.42);
      font-size:12px;
      border-right:1px solid rgba(16,17,20,.08);
    }
    .thumbIcon{
      width:44px; height:44px; border-radius:14px;
      background:rgba(16,17,20,.06);
      border:1px solid rgba(16,17,20,.10);
      display:grid; place-items:center;
      font-weight:800;
      color:rgba(16,17,20,.62);
    }

    .cardBody{padding:12px 12px 12px 12px; display:flex; flex-direction:column; gap:8px;}
    .cardTop{display:flex; flex-direction:column; gap:4px;}
    .cardTitle{margin:0; font-size:14px; font-weight:800; line-height:1.2;}
    .cardMeta{margin:0; font-size:12px; color:var(--muted); line-height:1.2;}
    .cardRow{display:flex; gap:8px; flex-wrap:wrap; align-items:center;}
    .date{
      border:1px solid rgba(16,17,20,.14);
      border-radius:10px;
      padding:8px 10px;
      font-size:12px;
      background:#fff;
    }
    .smallAction{
      border:1px solid rgba(16,17,20,.14);
      background:rgba(16,17,20,.04);
      padding:9px 10px;
      border-radius:12px;
      font-size:12px;
      cursor:pointer;
    }
    .smallActionPrimary{
      background:rgba(16,17,20,.92);
      color:rgba(255,255,255,.94);
      border-color:rgba(16,17,20,.12);
    }

    .link{
      font-size:12px;
      color:#0f172a;
      text-decoration:none;
      border-bottom:1px solid rgba(15,23,42,.22);
      width:max-content;
    }

    /* Plan pane */
    .planPane{
      border-left:1px solid rgba(16,17,20,.10);
      background:rgba(16,17,20,.02);
      padding:16px;
      overflow:auto;
    }
    .planPane h3{margin:0 0 6px 0; font-size:14px;}
    .planPane p{margin:0 0 12px 0; font-size:12px; color:var(--muted); line-height:1.3;}

    .planList{display:flex; flex-direction:column; gap:10px;}
    .planItem{
      border:1px solid rgba(16,17,20,.10);
      background:#fff;
      border-radius:14px;
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .planItem strong{font-size:13px;}
    .planItem span{font-size:12px; color:var(--muted); line-height:1.35;}
    .planActions{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}
    .dangerBtn{
      border:1px solid rgba(220,38,38,.18);
      background:rgba(220,38,38,.06);
      padding:9px 10px;
      border-radius:12px;
      font-size:12px;
      cursor:pointer;
      color:rgba(185,28,28,.95);
    }

    /* Detail drawer */
    .drawer{
      position:fixed;
      right:18px;
      top:86px;
      z-index:45;
      width:min(420px, 92vw);
      border-radius:18px;
      background:rgba(255,255,255,.86);
      border:1px solid rgba(16,17,20,.12);
      box-shadow:0 28px 90px rgba(0,0,0,.22);
      backdrop-filter: blur(12px);
      display:none;
      overflow:hidden;
    }
    .drawer.isOpen{display:block;}
    .drawerHead{
      padding:14px 14px 10px 14px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      border-bottom:1px solid rgba(16,17,20,.10);
      background:rgba(255,255,255,.92);
    }
    .drawerHead h4{margin:0; font-size:13px; font-weight:900;}
    .drawerClose{
      border:1px solid rgba(16,17,20,.10);
      background:rgba(16,17,20,.03);
      padding:8px 10px;
      border-radius:12px;
      font-size:12px;
      cursor:pointer;
    }
    .drawerBody{padding:12px 14px 14px 14px;}
    .drawerBody p{margin:0 0 10px 0; font-size:12px; color:rgba(16,17,20,.70); line-height:1.4;}
    .drawerGrid{display:grid; grid-template-columns:1fr 1fr; gap:10px;}
    .drawerField{
      border:1px solid rgba(16,17,20,.10);
      background:rgba(255,255,255,.95);
      border-radius:14px;
      padding:10px 10px;
    }
    .drawerField label{display:block; font-size:11px; color:rgba(16,17,20,.62); margin-bottom:6px;}
    .drawerField input, .drawerField textarea, .drawerField select{
      width:100%;
      border:1px solid rgba(16,17,20,.12);
      background:#fff;
      border-radius:10px;
      padding:8px 10px;
      font-size:12px;
      outline:none;
    }
    .drawerField textarea{min-height:74px; resize:vertical;}
    .drawerActions{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}

    /* Spacer creates scroll runway */
    .spacer{height:520vh;}
  </style>
</head>

<body>
  <!-- Brand Bar -->
  <div class="brandBar">
    <div class="brandLeft">
      <div class="logoMark"></div>
      <div class="brandText">
        <div class="brandName">Vivid Oasis</div>
        <div class="brandTag">Our Partners & Properties</div>
      </div>
    </div>
    <div class="brandRight">
      <button class="primaryBtn" id="openPortfolioBtn">View Portfolio</button>
    </div>
  </div>

  <!-- SVG Journey Overlay - Clean vertical trail -->
  <svg class="journey-overlay" viewBox="0 0 100 100">
    <defs>
      <linearGradient id="trailGradient" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" style="stop-color:#0ea5e9;stop-opacity:0.8" />
        <stop offset="50%" style="stop-color:#06b6d4;stop-opacity:0.9" />
        <stop offset="100%" style="stop-color:#14b8a6;stop-opacity:0.8" />
      </linearGradient>
    </defs>
    
    <!-- Vertical trail -->
    <line x1="50" y1="10" x2="50" y2="90" stroke="url(#trailGradient)" stroke-width="3" stroke-linecap="round" opacity="0.6" />
    
    <!-- Node markers at 20% intervals -->
    <circle cx="50" cy="20" r="5" fill="#fff" stroke="#0ea5e9" stroke-width="2" opacity="0.9" />
    <circle cx="50" cy="35" r="5" fill="#fff" stroke="#06b6d4" stroke-width="2" opacity="0.9" />
    <circle cx="50" cy="50" r="5" fill="#fff" stroke="#14b8a6" stroke-width="2" opacity="0.9" />
    <circle cx="50" cy="65" r="5" fill="#fff" stroke="#06b6d4" stroke-width="2" opacity="0.9" />
    <circle cx="50" cy="80" r="5" fill="#fff" stroke="#0ea5e9" stroke-width="2" opacity="0.9" />
  </svg>

  <!-- Portfolio Modal -->
  <div class="modal" id="portfolioModal">
    <div class="modalContent">
      <button class="closeBtn" id="closeModalBtn">√ó</button>
      <h2 style="margin:0 0 20px 0; color:var(--river-start);">Our Properties</h2>
      <p style="color:var(--muted); margin:0 0 30px 0;">Curated selections from our trusted partners based on your journey preferences</p>
      
      <div id="propertyContainer" class="propertyGrid">
        <p style="text-align:center; color:var(--muted);">Loading properties...</p>
      </div>
    </div>
  </div>

  <!-- Hero Section -->
  <section class="hero">
    <video class="video-background" autoplay muted loop playsinline>
      <source src="assets/oasis/waterfall_oasis.mp4" type="video/mp4">
    </video>
    <div>
      <h1>Vivid Oasis</h1>
      <p>Discover Our Properties</p>
    </div>
  </section>

  <!-- Section 1: Choose Intent -->
  <section class="section" data-video>
    <video class="video-background" muted loop playsinline>
      <source src="assets/city/city_skyline_timelapse.mp4" type="video/mp4">
    </video>
    <div class="content">
      <div class="formCard">
        <h3>Choose Intent</h3>
        <label><input type="radio" name="intent" value="adventure"> Adventure</label>
        <label><input type="radio" name="intent" value="relaxation"> Relaxation</label>
        <label><input type="radio" name="intent" value="culture"> Culture</label>
        <button class="nextBtn">Next ‚Üí</button>
      </div>
      <h2>Choose Your Intent</h2>
      <p>Define what brings you to your ideal location. Whether it's adventure, relaxation, or cultural exploration‚Äîyour journey starts here.</p>
      <ul>
        <li>Adventure & Exploration</li>
        <li>Relaxation & Peace</li>
        <li>Culture & History</li>
      </ul>
    </div>
  </section>

  <!-- Section 2: Select Region -->
  <section class="section" data-video>
    <video class="video-background" muted loop playsinline>
      <source src="assets/oasis/desert_dunes.mp4" type="video/mp4">
    </video>
    <div class="content">
      <div class="formCard">
        <h3>Select Region</h3>
        <select style="width:100%; padding:10px; border-radius:8px; border:2px solid #e5e7eb;">
          <option value="coastal">Coastal</option>
          <option value="mountain">Mountain</option>
          <option value="desert">Desert</option>
          <option value="urban">Urban</option>
        </select>
        <button class="nextBtn" style="margin-top:15px;">Next ‚Üí</button>
      </div>
      <h2>Select Your Region</h2>
      <p>From coastal retreats to mountain sanctuaries, choose the landscape that speaks to your soul.</p>
      <ul>
        <li>Coastal Escapes</li>
        <li>Mountain Hideaways</li>
        <li>Urban Oases</li>
        <li>Desert Serenity</li>
      </ul>
    </div>
  </section>

  <!-- Section 3: Set Preferences -->
  <section class="section" data-video>
    <video class="video-background" muted loop playsinline>
      <source src="assets/oasis/green_field_oasis.mp4" type="video/mp4">
    </video>
    <div class="content">
      <div class="formCard">
        <h3>Preferences</h3>
        <label><input type="checkbox"> Quiet Environment</label>
        <label><input type="checkbox"> Family Friendly</label>
        <label><input type="checkbox"> Pet Friendly</label>
        <button class="nextBtn" style="margin-top:10px;">Next ‚Üí</button>
      </div>
      <h2>Define Your Preferences</h2>
      <p>Tailor your search with specific amenities and requirements that match your lifestyle.</p>
      <ul>
        <li>Quiet Environment</li>
        <li>Family-Friendly Amenities</li>
        <li>Pet-Friendly Options</li>
        <li>Accessibility Features</li>
      </ul>
    </div>
  </section>

  <!-- Section 4: Budget & Distance -->
  <section class="section" data-video>
    <video class="video-background" muted loop playsinline>
      <source src="assets/city/city_night_lights.mp4" type="video/mp4">
    </video>
    <div class="content">
      <div class="formCard">
        <h3>Set Budget</h3>
        <input type="range" min="100000" max="1000000" step="10000" style="width:100%; margin:10px 0;">
        <p style="margin:10px 0; color:var(--muted); font-size:0.85rem;">$100k - $1M</p>
        <button class="nextBtn">Next ‚Üí</button>
      </div>
      <h2>Set Your Budget</h2>
      <p>Find our properties that align with your financial goals while maintaining the quality of life you deserve.</p>
      <ul>
        <li>Flexible Budget Ranges</li>
        <li>Distance Preferences</li>
        <li>Value Analysis</li>
        <li>Investment Opportunities</li>
      </ul>
    </div>
  </section>

  <!-- Section 5: Discover Properties -->
  <section class="section" data-video>
    <video class="video-background" muted loop playsinline>
      <source src="assets/city/city_timelapse_traffic.mp4" type="video/mp4">
    </video>
    <div class="content">
      <div class="formCard">
        <h3>Ready to Explore?</h3>
        <p style="margin:0 0 15px 0; color:var(--muted); font-size:0.9rem;">View our curated properties</p>
        <button class="nextBtn" onclick="document.getElementById('openPortfolioBtn').click();">View Portfolio ‚Üí</button>
      </div>
      <h2>Discover Your Oasis</h2>
      <p>Browse our curated portfolio of properties tailored to your unique preferences and vision.</p>
      <ul>
        <li>Handpicked Properties</li>
        <li>Virtual Tours Available</li>
        <li>Detailed Analytics</li>
        <li>Expert Guidance</li>
      </ul>
    </div>
  </section>

  <script>
    // Intersection Observer for video playback
    const videoObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const video = entry.target.querySelector('.video-background');
        if (video) {
          if (entry.isIntersecting) {
            video.play().catch(err => console.log('Video play failed:', err));
          } else {
            video.pause();
          }
        }
      });
    }, {
      threshold: 0.5
    });

    // Observe all sections with videos
    document.querySelectorAll('[data-video]').forEach(section => {
      videoObserver.observe(section);
    });
    
    // Portfolio Modal Controls
    const portfolioModal = document.getElementById('portfolioModal');
    const closeModalBtn = document.getElementById('closeModalBtn');
    
    if (closeModalBtn) {
      closeModalBtn.addEventListener('click', () => {
        portfolioModal.classList.remove('active');
      });
    }
    
    // Close modal when clicking outside
    portfolioModal.addEventListener('click', (e) => {
      if (e.target === portfolioModal) {
        portfolioModal.classList.remove('active');
      }
    });
    
    // Clean implementation - forms are now embedded in content divs
    
    // Load and display properties from JSON
    async function loadProperties() {
      try {
        const response = await fetch('a_data/links.json');
        const links = await response.json();
        const propertyContainer = document.getElementById('propertyContainer');
        
        // Filter Zillow links only
        const propertyLinks = links.filter(link => link.includes('zillow.com/homedetails'));
        
        propertyContainer.innerHTML = '';
        
        propertyLinks.forEach((link, index) => {
          // Extract address from URL
          const urlParts = link.split('/');
          const addressPart = urlParts[4] || '';
          const address = addressPart.split('-').slice(0, -3).join(' ').replace(/-/g, ' ');
          const city = addressPart.split('-').slice(-3, -2)[0] || 'Atlanta';
          const state = addressPart.split('-').slice(-2, -1)[0] || 'GA';
          const zip = addressPart.split('-').pop() || '';
          
          const card = document.createElement('div');
          card.className = 'propertyCard';
          card.innerHTML = `
            <div class="propertyImage"></div>
            <div class="propertyBody">
              <h3 class="propertyTitle">Property ${index + 1}</h3>
              <p class="propertyAddress">${address}, ${city}, ${state} ${zip}</p>
              <p class="propertyPrice">View Listing</p>
              <div class="propertyMeta">
                <span class="metaItem">üè† Condo</span>
                <span class="metaItem">üìç ${city}</span>
              </div>
            </div>
          `;
          
          card.addEventListener('click', () => {
            window.open(link, '_blank');
          });
          
          propertyContainer.appendChild(card);
        });
      } catch (error) {
        console.error('Error loading properties:', error);
        document.getElementById('propertyContainer').innerHTML = '<p style="text-align:center; color:var(--muted);">Unable to load properties</p>';
      }
    }
    
    // Load properties when modal opens
    if (openPortfolioBtn) {
      openPortfolioBtn.addEventListener('click', () => {
        portfolioModal.classList.add('active');
        loadProperties();
      });
    } else {
      // Fallback: load on page load if button doesn't exist
      loadProperties();
    }
    
    // Next button scrolling
    document.querySelectorAll('.nextBtn').forEach((btn, index) => {
      btn.addEventListener('click', () => {
        const nextSection = sections[index + 1];
        if (nextSection) {
          nextSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
        } else {
          portfolioModal.classList.add('active');
        }
      });
    });
  </script>
              <path class="iconStroke" d="M-16 14 H6"></path>
              <path class="iconStroke" d="M12 14 l8 8 l16-18"></path>
            </g>

            <!-- Step 4: Balance distance & budget -->
            <g id="node4" transform="translate(400 1400)">
              <circle class="nodeRing" r="60"></circle>
              <rect class="iconStroke" x="-20" y="-14" width="40" height="36" rx="6"></rect>
              <path class="iconStroke" d="M-20 0 H20"></path>
              <path class="iconStroke" d="M-8 -26 V-14"></path>
              <path class="iconStroke" d="M8 -26 V-14"></path>
            </g>

            <!-- Step 5: Arrive at properties -->
            <g id="node5" transform="translate(400 1800)">
              <circle class="nodeRing" r="60"></circle>
              <path class="iconStroke" d="M-18 3 l15 15 l28-34"></path>
            </g>
            
            <!-- Final destination -->
            <g id="node6" transform="translate(400 2200)">
              <circle class="nodeRing" r="60" fill="rgba(22,163,74,.15)"></circle>
              <path class="iconStroke" d="M-16 -12 L0 -26 L16 -12 L16 20 L-16 20 Z"></path>
              <path class="iconStroke" d="M0 -26 V2"></path>
            </g>
          </g>
          <!-- Dock connector lines and forms positioned to the right of nodes -->
          
          <!-- Step 1: Node at (400, 200) - Form to the right -->
          <line class="dockLine" x1="460" y1="200" x2="500" y2="200" />
          <foreignObject x="500" y="120" width="240" height="220">
            <div class="stepUI" xmlns="http://www.w3.org/1999/xhtml">
              <h3>Choose Intent</h3>
              <label><input type="radio" name="intent" value="adventure"/> Adventure</label>
              <label><input type="radio" name="intent" value="relaxation"/> Relaxation</label>
              <label><input type="radio" name="intent" value="culture"/> Culture</label>
              <button class="stepBtn">Next ‚Üí</button>
            </div>
          </foreignObject>

          <!-- Step 2: Node at (400, 600) - Form to the right -->
          <line class="dockLine" x1="460" y1="600" x2="500" y2="600" />
          <foreignObject x="500" y="520" width="240" height="180">
            <div class="stepUI" xmlns="http://www.w3.org/1999/xhtml">
              <h3>Select Region</h3>
              <select>
                <option>Coastal</option>
                <option>Mountain</option>
                <option>Urban</option>
                <option>Desert</option>
              </select>
              <button class="stepBtn">Next ‚Üí</button>
            </div>
          </foreignObject>

          <!-- Step 3: Node at (400, 1000) - Form to the right -->
          <line class="dockLine" x1="460" y1="1000" x2="500" y2="1000" />
          <foreignObject x="500" y="920" width="240" height="200">
            <div class="stepUI" xmlns="http://www.w3.org/1999/xhtml">
              <h3>Preferences</h3>
              <label><input type="checkbox"/> Quiet</label>
              <label><input type="checkbox"/> Family-friendly</label>
              <label><input type="checkbox"/> Pet-friendly</label>
              <button class="stepBtn">Next ‚Üí</button>
            </div>
          </foreignObject>

          <!-- Step 4: Node at (400, 1400) - Form to the right -->
          <line class="dockLine" x1="460" y1="1400" x2="500" y2="1400" />
          <foreignObject x="500" y="1320" width="240" height="220">
            <div class="stepUI" xmlns="http://www.w3.org/1999/xhtml">
              <h3>Budget</h3>
              <input type="range" min="1000" max="10000" value="5000"/>
              <p><span id="budgetValue">$5,000</span>/month</p>
              <label>Max distance: <input type="number" value="50"/> mi</label>
              <button class="stepBtn">Next ‚Üí</button>
            </div>
          </foreignObject>

          <!-- Step 5: Node at (400, 1800) - Form to the right -->
          <line class="dockLine" x1="460" y1="1800" x2="500" y2="1800" />
          <foreignObject x="500" y="1720" width="240" height="200">
            <div class="stepUI" xmlns="http://www.w3.org/1999/xhtml">
              <h3>Review</h3>
              <p>Intent: <strong id="reviewIntent">‚Äî</strong></p>
              <p>Region: <strong id="reviewRegion">‚Äî</strong></p>
              <p>Budget: <strong id="reviewBudget">‚Äî</strong></p>
              <button class="stepBtn stepBtnPrimary">View Portfolio ‚Üí</button>
            </div>
          </foreignObject>
        </svg>
      </div>
    </div>
  </section>

  <div class="infoCard" id="infoCard" aria-label="Info card">
    <div class="infoTop">
      <p class="infoTitle">How this Vivid Oasis MVP works</p>
      <button class="infoClose" id="closeInfoBtn" type="button">Close</button>
    </div>
    <div class="infoBody">
      <p class="infoLead">This is a guided location story üé•, that lands in a portfolio of dream properties üè†, where tours and acquisition intent are captured üìÖ.</p>
      <div class="infoRow">
        <div class="mini">
          <h4>1) Journey</h4>
          <p>Scroll to ‚Äútravel‚Äù the selection path üß≠, and arrive at the portfolio step ‚úÖ.</p>
        </div>
        <div class="mini">
          <h4>2) Portfolio</h4>
          <p>Links load from <strong>./a_data/links.json</strong> üîó, and become selectable cards.</p>
        </div>
        <div class="mini">
          <h4>3) Tour plan</h4>
          <p>Select dates üìÖ, mark acquisition interest üèÅ, then export a plan üì§.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="spacer" aria-hidden="true"></div>

  <!-- Properties overlay -->
  <div class="overlay" id="overlay" aria-label="Dream properties window">
    <div class="sheet" role="dialog" aria-modal="true" aria-label="Dream properties list">
      <div class="sheetHeader">
        <div class="titleBlock">
          <h2>Vivid Oasis Portfolio</h2>
          <p>Select properties ‚úÖ, set tour windows üìÖ, and produce an acquisition-ready plan üßæ.</p>
        </div>
        <div class="headerActions">
          <span class="pill" id="sourcePill">Source: ./a_data/links.json</span>
          <span class="pill pillWarn" id="countPill">Loading‚Ä¶</span>
          <button class="closeBtn" id="closeOverlayBtn" type="button">Close</button>
        </div>
      </div>

      <div class="gridPane">
        <div class="toolbar">
          <input class="input" id="search" placeholder="Search: address keywords, city, state, notes‚Ä¶" />
          <span class="pill" id="marketPill">Market: auto</span>
          <span class="pill pillOk" id="selectedPill">Selected: 0</span>
        </div>
        <div class="cards" id="cards"></div>
      </div>

      <aside class="planPane">
        <h3>Tour + Acquire Plan</h3>
        <p>This is the ‚Äúreal site‚Äù feeling üß†, where selections become commitments ‚úÖ, and a plan becomes shareable üì§.</p>
        <div class="planList" id="planList"></div>
        <div class="planActions">
          <button class="smallAction smallActionPrimary" id="exportCsvBtn" type="button">Export plan (CSV)</button>
          <button class="dangerBtn" id="clearPlanBtn" type="button">Clear</button>
        </div>
      </aside>
    </div>
  </div>

  <!-- Property detail drawer -->
  <div class="drawer" id="drawer" aria-label="Property details">
    <div class="drawerHead">
      <h4 id="drawerTitle">Property details</h4>
      <button class="drawerClose" id="drawerCloseBtn" type="button">Close</button>
    </div>
    <div class="drawerBody">
      <p id="drawerMeta">Attach intention üìå, so the plan reads like an acquisition workflow üßæ.</p>
      <div class="drawerGrid">
        <div class="drawerField">
          <label>Tour start</label>
          <input type="date" id="drawerStart" />
        </div>
        <div class="drawerField">
          <label>Tour end</label>
          <input type="date" id="drawerEnd" />
        </div>
        <div class="drawerField">
          <label>Acquisition intent</label>
          <select id="drawerIntent">
            <option value="explore">Explore</option>
            <option value="strong">Strong interest</option>
            <option value="priority">Priority acquire</option>
          </select>
        </div>
        <div class="drawerField">
          <label>Target offer range</label>
          <input type="text" id="drawerOffer" placeholder="$ ‚Äî optional" />
        </div>
        <div class="drawerField" style="grid-column:1 / -1;">
          <label>Notes</label>
          <textarea id="drawerNotes" placeholder="Why this property matters to the Vivid Oasis portfolio‚Ä¶"></textarea>
        </div>
      </div>
      <div class="drawerActions">
        <button class="smallAction smallActionPrimary" id="drawerAddToPlanBtn" type="button">Add / update in plan</button>
        <a class="smallAction link" id="drawerOpenLink" href="#" target="_blank" rel="noopener noreferrer">Open Zillow link</a>
      </div>
    </div>
  </div>

  <script>
    // =========================
    // Vivid Oasis: vertical river journey
    // =========================
    const board = document.querySelector(".board");
    const budgetRange = document.querySelector('input[type="range"]');
    const budgetValue = document.getElementById("budgetValue");
    
    // Auto-scroll to top on load
    if (board) {
      board.scrollTop = 0;
    }
    
    // Budget slider update
    if (budgetRange && budgetValue) {
      budgetRange.addEventListener("input", (e) => {
        budgetValue.textContent = "$" + parseInt(e.target.value).toLocaleString();
      });
    }
    
    // Auto-scroll board vertically as user scrolls page
    function getScrollProgress01() {
      const max = document.documentElement.scrollHeight - window.innerHeight;
      if (max <= 0) return 0;
      return window.scrollY / max;
    }
    
    function tick() {
      if (!board) return;
      const progress = getScrollProgress01();
      const maxScroll = board.scrollHeight - board.clientHeight;
      board.scrollTop = progress * maxScroll;
      requestAnimationFrame(tick);
    }
    
    requestAnimationFrame(tick);
    requestAnimationFrame(tick);

    // =========================
    // Portfolio + plan
    // =========================
    const DATA_URL = "./a_data/links.json";

    const dataChip = document.getElementById("dataChip");
    const selChip  = document.getElementById("selChip");

    const overlay = document.getElementById("overlay");
    const openPropertiesBtn = document.getElementById("openPropertiesBtn");
    const openPropertiesTopBtn = document.getElementById("openPropertiesTopBtn");
    const requestToursTopBtn = document.getElementById("requestToursTopBtn");
    const closeOverlayBtn = document.getElementById("closeOverlayBtn");

    const cardsEl = document.getElementById("cards");
    const planListEl = document.getElementById("planList");
    const searchEl = document.getElementById("search");
    const countPill = document.getElementById("countPill");
    const marketPill = document.getElementById("marketPill");
    const selectedPill = document.getElementById("selectedPill");

    const exportCsvBtn = document.getElementById("exportCsvBtn");
    const clearPlanBtn = document.getElementById("clearPlanBtn");

    const infoCard = document.getElementById("infoCard");
    const openInfoBtn = document.getElementById("openInfoBtn");
    const closeInfoBtn = document.getElementById("closeInfoBtn");

    // Drawer
    const drawer = document.getElementById("drawer");
    const drawerTitle = document.getElementById("drawerTitle");
    const drawerMeta = document.getElementById("drawerMeta");
    const drawerCloseBtn = document.getElementById("drawerCloseBtn");
    const drawerStart = document.getElementById("drawerStart");
    const drawerEnd = document.getElementById("drawerEnd");
    const drawerIntent = document.getElementById("drawerIntent");
    const drawerOffer = document.getElementById("drawerOffer");
    const drawerNotes = document.getElementById("drawerNotes");
    const drawerAddToPlanBtn = document.getElementById("drawerAddToPlanBtn");
    const drawerOpenLink = document.getElementById("drawerOpenLink");

    let allProps = [];
    let activeProp = null;

    // Plan: id -> plan item
    const plan = new Map();

    function openOverlay() { overlay.classList.add("isOpen"); }
    function closeOverlay() { overlay.classList.remove("isOpen"); closeDrawer(); }

    function openInfo(){ infoCard.style.display = "block"; }
    function closeInfo(){ infoCard.style.display = "none"; }

    openInfoBtn.addEventListener("click", openInfo);
    closeInfoBtn.addEventListener("click", closeInfo);

    openPropertiesBtn.addEventListener("click", openOverlay);
    openPropertiesTopBtn.addEventListener("click", openOverlay);
    closeOverlayBtn.addEventListener("click", closeOverlay);

    overlay.addEventListener("click", (e) => { if (e.target === overlay) closeOverlay(); });

    requestToursTopBtn.addEventListener("click", () => {
      openOverlay();
      if (plan.size === 0) {
        setTimeout(() => alert("No tours selected yet. Select a property, set dates, then add it to the plan."), 50);
      } else {
        setTimeout(() => alert("Tour request prepared. Export the plan as CSV to share."), 50);
      }
    });

    drawerCloseBtn.addEventListener("click", () => closeDrawer());

    function safeText(v){ return (v == null ? "" : String(v)); }

    function looksLikeUrl(str){
      try { new URL(str); return true; } catch { return false; }
    }

    function extractZpid(urlStr){
      const m = urlStr.match(/\/(\d+)_zpid/i);
      return m ? m[1] : "";
    }

    function inferMarket(urlStr){
      const u = urlStr.toLowerCase();
      if (u.includes("atlanta-ga")) return "Atlanta, GA";
      if (u.includes("sandy-springs-ga")) return "Sandy Springs, GA";
      if (u.includes("-ga-")) return "Georgia";
      return "";
    }

    function titleFromUrl(urlStr, idx){
      if (urlStr.includes("youtube.com")) return `External link ${idx + 1}`;
      if (urlStr.includes("zillow.com")) {
        const zpid = extractZpid(urlStr);
        return zpid ? `Zillow Property ¬∑ ZPID ${zpid}` : `Zillow Property ${idx + 1}`;
      }
      return `Property ${idx + 1}`;
    }

    function normalizeLinksToProps(list){
      const urls = list
        .filter(x => typeof x === "string")
        .map(x => x.trim())
        .filter(x => looksLikeUrl(x));

      const filtered = urls.filter(u => !u.includes("youtube.com"));

      return filtered.map((url, idx) => ({
        id: extractZpid(url) || String(idx + 1),
        title: titleFromUrl(url, idx),
        city: inferMarket(url),
        url,
        image: "",
        notes: ""
      }));
    }

    function updateSelectionCounters(){
      const selectedCount = plan.size;
      selChip.textContent = `Selected: ${selectedCount}`;
      selectedPill.textContent = `Selected: ${selectedCount}`;
    }

    function renderPlan(){
      planListEl.innerHTML = "";

      if (plan.size === 0) {
        const empty = document.createElement("div");
        empty.className = "planItem";
        empty.innerHTML = `<strong>No tours selected yet</strong><span>Select a property ‚úÖ, set dates üìÖ, then add it to the plan üßæ.</span>`;
        planListEl.appendChild(empty);
        updateSelectionCounters();
        return;
      }

      for (const item of plan.values()) {
        const div = document.createElement("div");
        div.className = "planItem";

        const intentLabel =
          item.intent === "priority" ? "Priority acquire" :
          item.intent === "strong" ? "Strong interest" :
          "Explore";

        const offer = item.offer ? ` ¬∑ Offer: ${safeText(item.offer)}` : "";
        const notes = item.notes ? `<span>Notes: ${safeText(item.notes)}</span>` : "";

        div.innerHTML = `
          <strong>${safeText(item.title)}</strong>
          <span>${safeText(item.city)} ¬∑ ${safeText(item.start)} ‚Üí ${safeText(item.end)} ¬∑ ${intentLabel}${offer}</span>
          ${notes}
          <a class="link" href="${item.url}" target="_blank" rel="noopener noreferrer">Open Zillow link</a>
          <button class="smallAction" type="button" data-remove="${item.id}">Remove</button>
        `;

        div.querySelector('button[data-remove]').addEventListener("click", (e) => {
          const id = e.currentTarget.getAttribute("data-remove");
          plan.delete(id);
          renderPlan();
          renderCards();
        });

        planListEl.appendChild(div);
      }

      updateSelectionCounters();
    }

    function downloadText(filename, text) {
      const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    function exportPlanCsv(){
      const rows = [
        ["brand","title","market","tour_start","tour_end","intent","offer_range","notes","zillow_url"]
      ];
      for (const item of plan.values()) {
        rows.push([
          "Vivid Oasis",
          item.title,
          item.city,
          item.start,
          item.end,
          item.intent,
          item.offer || "",
          item.notes || "",
          item.url
        ]);
      }
      const csv = rows.map(r =>
        r.map(cell => `"${String(cell ?? "").replaceAll('"','""')}"`).join(",")
      ).join("\n");
      downloadText("vivid-oasis-tour-plan.csv", csv);
    }

    exportCsvBtn.addEventListener("click", exportPlanCsv);
    clearPlanBtn.addEventListener("click", () => { plan.clear(); renderPlan(); renderCards(); });

    function matchesQuery(p, q){
      if (!q) return true;
      const hay = `${p.title} ${p.city} ${p.notes} ${p.url}`.toLowerCase();
      return hay.includes(q.toLowerCase());
    }

    function openDrawerForProp(prop){
      activeProp = prop;
      drawerTitle.textContent = prop.title;
      drawerMeta.textContent = `Market: ${prop.city || "Unknown"} ¬∑ ID: ${prop.id}`;
      drawerOpenLink.href = prop.url;

      const existing = plan.get(prop.id);
      drawerStart.value  = existing?.start || "";
      drawerEnd.value    = existing?.end || "";
      drawerIntent.value = existing?.intent || "explore";
      drawerOffer.value  = existing?.offer || "";
      drawerNotes.value  = existing?.notes || "";

      drawer.classList.add("isOpen");
    }

    function closeDrawer(){
      activeProp = null;
      drawer.classList.remove("isOpen");
    }

    drawerAddToPlanBtn.addEventListener("click", () => {
      if (!activeProp) return;

      const start = drawerStart.value;
      const end   = drawerEnd.value;

      if (!start || !end) { alert("Select both tour start and tour end."); return; }
      if (end < start) { alert("Tour end must be on or after tour start."); return; }

      plan.set(activeProp.id, {
        id: activeProp.id,
        title: activeProp.title,
        city: activeProp.city,
        url: activeProp.url,
        start,
        end,
        intent: drawerIntent.value,
        offer: drawerOffer.value.trim(),
        notes: drawerNotes.value.trim()
      });

      renderPlan();
      renderCards();
    });

    function renderCards(){
      const q = searchEl.value.trim();
      const filtered = allProps.filter(p => matchesQuery(p, q));

      countPill.textContent = `${filtered.length} properties`;
      countPill.classList.remove("pillWarn");
      countPill.classList.add("pillOk");

      cardsEl.innerHTML = "";
      filtered.forEach((p, idx) => {
        const card = document.createElement("div");
        card.className = "card";

        const selected = plan.has(p.id);
        if (selected) card.classList.add("cardSelected");

        const badgeText =
          selected ? "Selected" :
          (idx < 3 ? "Featured" : "Candidate");

        const badge = document.createElement("div");
        badge.className = "badge";
        badge.textContent = badgeText;

        const thumb = document.createElement("div");
        thumb.className = "thumb";
        const icon = document.createElement("div");
        icon.className = "thumbIcon";
        icon.textContent = "VO";
        thumb.appendChild(icon);

        const body = document.createElement("div");
        body.className = "cardBody";
        const existing = plan.get(p.id);

        body.innerHTML = `
          <div class="cardTop">
            <p class="cardTitle">${safeText(p.title)}</p>
            <p class="cardMeta">${safeText(p.city || "Market unknown")} ¬∑ ID ${safeText(p.id)}</p>
            <a class="link" href="${p.url}" target="_blank" rel="noopener noreferrer">Open Zillow link</a>
          </div>
          <div class="cardRow">
            <button class="smallAction" type="button" data-open="${p.id}">Details</button>
            <button class="smallAction ${selected ? "" : "smallActionPrimary"}" type="button" data-toggle="${p.id}">
              ${selected ? "Remove" : "Select"}
            </button>
            <button class="smallAction" type="button" data-quick="${p.id}">Quick tour</button>
          </div>
          <div class="cardRow">
            <span class="pill">${existing ? `Tour: ${existing.start} ‚Üí ${existing.end}` : "No tour dates set"}</span>
          </div>
        `;

        card.appendChild(badge);
        card.appendChild(thumb);
        card.appendChild(body);

        body.querySelector(`button[data-open="${p.id}"]`).addEventListener("click", () => openDrawerForProp(p));

        body.querySelector(`button[data-toggle="${p.id}"]`).addEventListener("click", () => {
          if (plan.has(p.id)) {
            plan.delete(p.id);
            renderPlan();
            renderCards();
          } else {
            openDrawerForProp(p);
          }
        });

        body.querySelector(`button[data-quick="${p.id}"]`).addEventListener("click", () => {
          openDrawerForProp(p);
          const today = new Date();
          const start = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 7);
          const end   = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 9);
          drawerStart.value = start.toISOString().slice(0,10);
          drawerEnd.value   = end.toISOString().slice(0,10);
        });

        cardsEl.appendChild(card);
      });

      updateSelectionCounters();
    }

    searchEl.addEventListener("input", renderCards);

    async function loadLinksJson(){
      try{
        const res = await fetch(DATA_URL, { cache:"no-store" });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);

        const data = await res.json();
        if (!Array.isArray(data)) throw new Error("links.json must be an array of URL strings");

        allProps = normalizeLinksToProps(data);

        const markets = new Set(allProps.map(p => p.city).filter(Boolean));
        marketPill.textContent = markets.size ? `Market: ${Array.from(markets).slice(0,2).join(" + ")}` : "Market: unknown";

        dataChip.textContent = `Data: loaded (${allProps.length})`;
        dataChip.classList.add("chipStrong");

        renderCards();
        renderPlan();
      } catch(e){
        dataChip.textContent = `Data: failed`;
        countPill.textContent = "Data load failed";
        countPill.classList.add("pillWarn");
        cardsEl.innerHTML = `
          <div class="planItem" style="grid-column:1 / -1;">
            <strong>Could not load ./a_data/links.json</strong>
            <span>Serve this folder over http(s) üß≠, and ensure the JSON is valid.</span>
            <span>Details: ${safeText(e.message || e)}</span>
          </div>
        `;
        renderPlan();
      }
    }

    // =========================
    // Boot sequence
    // =========================
    openInfo();
    loadLinksJson();
  </script>
</body>
</html>
